{"_id":"~41271344","createdBy":"admin@lab.local","updatedBy":"admin@lab.local","createdAt":1734970107594,"updatedAt":1748893808542,"_type":"caseTemplate","name":"IRM#2 Windows Intrusion","displayName":"","titlePrefix":"","description":"Live Analysis on a suspicious Windows system","severity":3,"tags":[],"flag":false,"tlp":2,"pap":2,"tasks":[{"id":"~41226392","_id":"~41226392","createdBy":"admin@lab.local","createdAt":1748893808527,"_type":"case_task","title":"Unusual Registry Entries","group":"Identification","description":"Look for unusual programs launched at boot time in the Windows registry, especially:\n- `HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run`\n- `HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Runonce`\n- `HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\RunonceEx` \n- Use `HiJackThis` if possible. (Also have a look in your Startup folder)","status":"Waiting","flag":false,"order":7},{"id":"~41230488","_id":"~41230488","createdBy":"admin@lab.local","createdAt":1748893808534,"_type":"case_task","title":"Check all files accessed recently","group":"Containment","description":"","status":"Waiting","flag":false,"order":17},{"id":"~41234584","_id":"~41234584","createdBy":"admin@lab.local","createdAt":1748893808535,"_type":"case_task","title":"Inspect network","group":"Containment","description":"Inspect network shares to see if the malware has spread\nthrough it.","status":"Waiting","flag":false,"order":18},{"id":"~41238680","_id":"~41238680","createdBy":"admin@lab.local","createdAt":1748893808539,"_type":"case_task","title":"Restore all changed files","group":"Recovery","description":"No matter how far the hacker has gone into the system and the knowledge you might have about the compromission, as long as the system has been penetrated, the best practice is **to reinstall the system fully from original media and apply all fixes to the newly installed system.**\n\nIn case this solution can’t be applied, you should:\n\nRestore all files that could have been changed (Example: `svchost.exe`) by the attacker.","status":"Waiting","flag":false,"order":24},{"id":"~82137264","_id":"~82137264","createdBy":"admin@lab.local","createdAt":1748893808525,"_type":"case_task","title":"Know your services","group":"Preparation","description":"A good knowledge of the usual services running on the machine can be very helpful. \n\nDon’t hesitate to ask a Windows Expert for his assistance, when applicable. \n\nA good idea is also to have a map of all services/running process of the machine.\n\n** Be prepared to notify abuse teams and law enforcement services and regulators if required during an incident (cell crisis management).**","status":"Waiting","flag":false,"order":4},{"id":"~82178136","_id":"~82178136","createdBy":"admin@lab.local","createdAt":1748893808526,"_type":"case_task","title":"Unusual accounts","group":"Identification","description":"Look for unusual accounts created, especially in the Administrators group:\n```\nC:\\> lusrmgr.msc\n```\nor\n```\nC:\\> net localgroup administrators or net localgroup administrateurs\n```","status":"Waiting","flag":false,"order":5},{"id":"~82182232","_id":"~82182232","createdBy":"admin@lab.local","createdAt":1748893808536,"_type":"case_task","title":"Find initial access","group":"Containment","description":"try to find how the attacker got into the system. All leads should be considered. If no computer proof of the intrusion is found, never forget it could come from a physical access or a complicity/stealing of information from an employee.","status":"Waiting","flag":false,"order":19},{"id":"~123121744","_id":"~123121744","createdBy":"admin@lab.local","createdAt":1748893808524,"_type":"case_task","title":"Make disk copy","group":"Preparation","description":"A physical copy of the hard-disk might be necessary for forensic and evidence purposes. \n\nFinally, if needed, a physical access could be needed to disconnect the suspected machine from any network.","status":"Waiting","flag":false,"order":2},{"id":"~123125840","_id":"~123125840","createdBy":"admin@lab.local","createdAt":1748893808531,"_type":"case_task","title":"Unusual log entries","group":"Identification","description":"Watch your log files for unusual entries:\n```\nC:\\> eventvwr.msc\n```\n\nIf possible, use `Event Log Viewer` or such tool\n\nSearch for events affecting the firewall, the antivirus, the file protection, or any suspicious new service.\n\nLook for a huge amount of failed login attempts or locked out accounts.\n\nWatch your firewall (if any) log files for suspect activity.","status":"Waiting","flag":false,"order":13},{"id":"~123129936","_id":"~123129936","createdBy":"admin@lab.local","createdAt":1748893808533,"_type":"case_task","title":"Malware check","group":"Identification","description":"Run at least one anti-virus product on the whole disk. If possible use several anti-virus.\n\n**The anti-virus must absolutely be up-to-date.**","status":"Waiting","flag":false,"order":15},{"id":"~123134032","_id":"~123134032","createdBy":"admin@lab.local","createdAt":1748893808534,"_type":"case_task","title":"Find all files used by the attacker","group":"Containment","description":"Find all files used by the attacker including deleted files (use your forensic tools) and see what has been done with it or at least their functionality, in order to evaluate the threat.\n\nIf the machine is considered critical for your company’s business activity and can’t be disconnected, backup all important data in case the hacker notices you’re investigating and starts deleting files. Also make a copy of the system’s memory for further analysis. (use tools such as Memoryze,win32dd etc.)\n\nMake a physical copy (bit by bit) of the whole hard disk on an external storage support, using EnCase, X-Ways, or similar forensic tool (dd, ddrescue etc.).","status":"Waiting","flag":false,"order":16},{"id":"~123191520","_id":"~123191520","createdBy":"admin@lab.local","createdAt":1748893808532,"_type":"case_task","title":"Rootkit check","group":"Identification","description":"Run\n- `Rootkit Revealer`,\n- `Rootkit Hooker`,\n- `Ice Sword`,\n- `Rk Detector`,\n- `SysInspector`,\n- `Rootkit Buster`.\n\nIt’s always better to run several of these tools than only one.","status":"Waiting","flag":false,"order":14},{"id":"~123195592","_id":"~123195592","createdBy":"admin@lab.local","createdAt":1748893808523,"_type":"case_task","title":"Provide access to forensic investigator","group":"Preparation","description":"In absense of EDR, a physical access to the suspicious system should be given to the forensic investigator. Physical access is preferred to remote access, since the hacker could detect the investigations done on the system (by using a network sniffer for example).","status":"Waiting","flag":false,"order":1},{"id":"~123195616","_id":"~123195616","createdBy":"admin@lab.local","createdAt":1748893808540,"_type":"case_task","title":"Report","group":"Lessons Learned","description":"A crisis report should be written and made available to all of the actors of the crisis management cell.\n\nThe following themes should be described: \n- Initial detection\n- Actions and timelines of every important event \n- What went right\n- What went wrong\n- Incident cost\n- Indicators of Compromise","status":"Waiting","flag":false,"order":25},{"id":"~123338792","_id":"~123338792","createdBy":"admin@lab.local","createdAt":1748893808522,"_type":"case_task","title":"Deploy EDR (if possible)","group":"Preparation","description":"Deploy an EDR solution on endpoints and servers.\n  - This tool became one of the cornerstones of the incident response in case of ransomware or in large scale compromise, facilitating identification, containment, and remediation phases.\n  - Launch EDR search and AV scan with IoC explicit rules and get first indicators for remediation progress following.\n  - Set your EDR policy in prevent mode","status":"Waiting","flag":false,"order":0},{"id":"~123342888","_id":"~123342888","createdBy":"admin@lab.local","createdAt":1748893808528,"_type":"case_task","title":"Unusual processes and services","group":"Identification","description":"Check all running processes for unusual/unknown entries, especially processes with username “SYSTEM” and “ADMINISTRATOR”:\n```\nC:\\> taskmgr.exe\n```\n\n(or `tlisk`, `tasklist` depending on Windows release)\n\nUse `psexplorer` if possible.","status":"Waiting","flag":false,"order":8},{"id":"~123346984","_id":"~123346984","createdBy":"admin@lab.local","createdAt":1748893808529,"_type":"case_task","title":"Look for unusual/unexpected network services installed and started","group":"Identification","description":"```\nC:\\> services.msc\n```\n\n```\nC:\\> net start\n```","status":"Waiting","flag":false,"order":10},{"id":"~123351080","_id":"~123351080","createdBy":"admin@lab.local","createdAt":1748893808531,"_type":"case_task","title":"Unusual Automated Tasks","group":"Identification","description":"Look at the list of scheduled tasks for any unusual entry: \n\n```\nC:\\> at\n```\n\nOn Windows 2003/XP:\n```\nC:\\> schtasks\n```","status":"Waiting","flag":false,"order":12},{"id":"~123355176","_id":"~123355176","createdBy":"admin@lab.local","createdAt":1748893808537,"_type":"case_task","title":"Apply fixes","group":"Containment","description":"Apply fixes when applicable (operating system and applications), in case the attacker used a known vulnerability.","status":"Waiting","flag":false,"order":20},{"id":"~164134944","_id":"~164134944","createdBy":"admin@lab.local","createdAt":1748893808524,"_type":"case_task","title":"Know your network","group":"Preparation","description":"A good knowledge of the usual network activity of the machine/server is needed. \n\nYou should have a file on a secure place describing the usual port activity, to compare efficiently to the current state.","status":"Waiting","flag":false,"order":3},{"id":"~164139040","_id":"~164139040","createdBy":"admin@lab.local","createdAt":1748893808539,"_type":"case_task","title":"Change system accounts passwords","group":"Recovery","description":"No matter how far the hacker has gone into the system and the knowledge you might have about the compromission, as long as the system has been penetrated, the best practice is to reinstall the system fully from original media and apply all fixes to the newly installed system.\nIn case this solution can’t be applied, you should:\n\nChange all the system’s accounts passwords, and make your users do so in a secure way: \nthey should use passwords with upper/lower case, special characters, numbers, and at least be 8 characters long.","status":"Waiting","flag":false,"order":23},{"id":"~164143136","_id":"~164143136","createdBy":"admin@lab.local","createdAt":1748893808541,"_type":"case_task","title":"Capitalize","group":"Lessons Learned","description":"Actions to improve the Windows intrusion detection management processes should be defined to capitalize on this experience.\n\nProfiles of acquisition tools can be tweaked to better match artifacts detected during the investigation.","status":"Waiting","flag":false,"order":26},{"id":"~205119488","_id":"~205119488","createdBy":"admin@lab.local","createdAt":1748893808526,"_type":"case_task","title":"Unusual files","group":"Identification","description":"- Look for unusually big files on the storage support, bigger than 5MB. (can be an indication of a system compromised for illegal content storage)\n- Look for unusual files added recently in system folders, especially `C:\\WINDOWS\\system32`.\n- Look for files using the “hidden” attribute:\n```\nC:\\> dir /S /A:H\n```\n\nUse `windirstat` if possible.","status":"Waiting","flag":false,"order":6},{"id":"~205123584","_id":"~205123584","createdBy":"admin@lab.local","createdAt":1748893808529,"_type":"case_task","title":"Check user's autostart folders","group":"Identification","description":"```\nC:\\Documents and Settings\\user\\Start Menu\\Programs\\Startup \n```\n\n```\nC:\\WinNT\\Profiles\\user\\Start Menu\\Programs\\Startup\n```","status":"Waiting","flag":false,"order":9},{"id":"~205127680","_id":"~205127680","createdBy":"admin@lab.local","createdAt":1748893808530,"_type":"case_task","title":"Unusual Network Activity","group":"Identification","description":"- Check for file shares and verify each one is linked to a normal activity:\n```\nC:\\> net view \\\\127.0.0.1\n```\n\nUse `tcpview` if possible.\n\n- Look at the opened sessions on the machine:\n```\nC:\\> net session\n```\n- Have a look at the sessions the machine has opened with other systems:\n```\nC:\\> net use\n```\n- Check for any suspicious Netbios connexion:\n```\nC:\\> nbtstat –S\n```\n- Look for any suspicious activity on the system’s ports :\n```\nC:\\> netstat –na 5\n```\n(5 makes it being refreshed each 5 seconds)\nUse –o flag for Windows XP/2003 to see the owner of each process:\n```\nC:\\> netstat –nao 5\n```\n\nUse `fport` if possible.","status":"Waiting","flag":false,"order":11},{"id":"~205131776","_id":"~205131776","createdBy":"admin@lab.local","createdAt":1748893808537,"_type":"case_task","title":"Remove access to the accounts involved","group":"Remediation","description":"Temporary remove all accesses to the accounts involved in the incident.","status":"Waiting","flag":false,"order":21},{"id":"~205135872","_id":"~205135872","createdBy":"admin@lab.local","createdAt":1748893808538,"_type":"case_task","title":"Remove malicious files","group":"Remediation","description":"Remove all malicious files installed by the attacker.","status":"Waiting","flag":false,"order":22}],"status":"Ok","customFields":{},"metrics":{}}