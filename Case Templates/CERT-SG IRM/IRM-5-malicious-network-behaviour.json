{"_id":"~393448","createdBy":"admin@lab.local","updatedBy":"admin@lab.local","createdAt":1734970143445,"updatedAt":1748876954676,"_type":"caseTemplate","name":"IRM#5 Malicious Network Behaviour","displayName":"","titlePrefix":"","description":"Guidelines to handle a suspicious network activity","severity":1,"tags":[],"flag":false,"tlp":2,"pap":2,"tasks":[{"id":"~41021592","_id":"~41021592","createdBy":"admin@lab.local","createdAt":1748876954666,"_type":"case_task","title":"Sources of detections","group":"Identification","description":"- Notification by user/helpdesk\n- IDS/IPS/NODS.EDR logs, alerts and reports.\n- Detection by network staff.\n- Firewall and proxy logs.\n- Complaint from an external source.\n- Honeypots or any other deceptive solution.\n","status":"Waiting","flag":false,"order":3},{"id":"~41025688","_id":"~41025688","createdBy":"admin@lab.local","createdAt":1748876954667,"_type":"case_task","title":"Record suspect network activity","group":"Identification","description":"Network frames can be stored into a file and transmitted to your incident response team for further analysis.\n\nUse network capture tools (`tshark`, `windump`, `tcpdump` ...) to dump malicious traffic. Use a hub or port mirroring on an affected LAN to collect valuable data.\n\n**Network forensic requires skills and knowledge. Ask your incident response team for assistance or advice.**\n\nLnow how to restore and consult logs even when they have been archived.","status":"Waiting","flag":false,"order":4},{"id":"~81977520","_id":"~81977520","createdBy":"admin@lab.local","createdAt":1748876954662,"_type":"case_task","title":"Intrusion Detection Systems","group":"Preparation","description":"- Ensure that the monitoring tools are up to date;\n- Establish contacts with your network and security\noperation teams;\n- Make sure that an alert notification process is defined and well-known from everyone.\n- Verify access to the device and its ability to watch concerned perimeters.\n- Ensure that you can isolate endpoints, area (with EDR for example or Firewall)","status":"Waiting","flag":false,"order":0},{"id":"~81981616","_id":"~81981616","createdBy":"admin@lab.local","createdAt":1748876954670,"_type":"case_task","title":"Block the source","group":"Remediation","description":"- Using analysis from previous steps identification and containment, find out all communication channels used by the attacker and block them on all your network boundaries.\n- If the source has been identified as an insider, take appropriate actions and involve your management and/or HR team and/or legal team.\n- If the source has been identified as an external offender, consider involving abuse teams and law enforcement services if required.","status":"Waiting","flag":false,"order":7},{"id":"~122945616","_id":"~122945616","createdBy":"admin@lab.local","createdAt":1748876954665,"_type":"case_task","title":"Baseline traffic","group":"Preparation","description":"- Identify the baseline traffic and flows\n- Identify the business-critical flows.\n\n**Make sure people are comfortable with the tools and know how to use them.**\n\n**Keep logs operational even when they have been archived.**\n\n**Having a good log retention policy is essential (more than 6 months).**","status":"Waiting","flag":false,"order":2},{"id":"~122949712","_id":"~122949712","createdBy":"admin@lab.local","createdAt":1748876954671,"_type":"case_task","title":"Test and enforce","group":"Remediation","description":"- Test the remediation process and make sure that it properly works without damaging any service.\n- Enforce the remediation process once tests have been approved by both IT and business.","status":"Waiting","flag":false,"order":9},{"id":"~122953808","_id":"~122953808","createdBy":"admin@lab.local","createdAt":1748876954672,"_type":"case_task","title":"Restore the system to normal operations","group":"Recovery","description":"1. Ensure that the network traffic is back to normal\n2. Re-allow the network traffic that was used as a propagation method by the attacker\n3. Reconnect sub-areas together if necessary \n4. Reconnect the area to your local network if necessary\n5. Reconnect the area to the Internet if necessary\n\n**All of these steps shall be made in a step-by-step manner and with a technical monitoring.**","status":"Waiting","flag":false,"order":10},{"id":"~122994912","_id":"~122994912","createdBy":"admin@lab.local","createdAt":1748876954668,"_type":"case_task","title":"Analyze the attack","group":"Identification","description":"- Analyze alerts generated by your IDS;\n- Review statistics and logs of network devices;\n- Try to understand the goal of the malicious traffic and identify the infrastructure components affected by it;\n- Identify the technical characteristics of the traffic:\n  - Source IP address(es)\n  - Ports used, TTL, Packet ID, ...\n  - Protocols used\n  - Targeted machines/services\n  - Exploit(s)\n  - Remote accounts logged in\n\n**At the end of this step, the impacted machines and the modus operandi of the attack should have been identified. Ideally, the source of the attack should have been identified as well. This is where you should do your forensic investigations, if needed.**\n\n**If a compromised computer has been identified, check IRM cheat sheets dedicated to intrusion.**","status":"Waiting","flag":false,"order":5},{"id":"~122999008","_id":"~122999008","createdBy":"admin@lab.local","createdAt":1748876954671,"_type":"case_task","title":"Technical remediation","group":"Remediation","description":"- Define a remediation process. If necessary, this process can be validated by another structure, like your incident response team for example.\n- Remediation steps from intrusion IRM(2-Windows and 3-Linux) can also be useful.","status":"Waiting","flag":false,"order":8},{"id":"~123003104","_id":"~123003104","createdBy":"admin@lab.local","createdAt":1748876954674,"_type":"case_task","title":"Capitalize","group":"Lessons Learned","description":"Actions to improve the network intrusion management processes should be defined to capitalize on this experience.","status":"Waiting","flag":false,"order":12},{"id":"~123019304","_id":"~123019304","createdBy":"admin@lab.local","createdAt":1748876954673,"_type":"case_task","title":"Report","group":"Lessons Learned","description":"A report should be written and made available to all of the actors.\n\nThe following themes should be described:\n- Initial cause of the issue\n- Actions and timelines\n- What went right\n- What went wrong\n- Incident cost\n- Indicators of Compromise","status":"Waiting","flag":false,"order":11},{"id":"~163950624","_id":"~163950624","createdBy":"admin@lab.local","createdAt":1748876954669,"_type":"case_task","title":"Mitigate the attack effects on the neighbouring IT resources","group":"Containment","description":"**If the issue is considered as strategic (sensitive resources access), a specific crisis management cell should be activated.**\n\nDepending on the criticality of the impacted resources, the following steps can be performed and monitored:\n- Disconnect the compromised area from the network.\n- Isolate the source of the attack. Disconnect the affected computer(s) in order to perform further investigation.\n- Find acceptable mitigation measures for the business-critical traffic in agreement with the business line managers.\n- Terminate unwanted connections or processes on affected machines.\n- Use firewall/IPS/EDR rules to block the attack.\n- Use IDS rules to match with this malicious behavior and inform technical staff on new events.\n- Apply ad hoc actions in case of strategic issue:\n  - Deny egress destination in EDR, proxies and/or firewalls.\n  - Configure security controls policy management to contain or reject connections from compromised machines.\n  - Limit access to critical/confidential data; that is, select what kind of files can be lost / stolen and restrict the access for confidential files;\n  - Create booby-trapped documents (that is fake documents) with matermarking that could be used as a proof of theft.\n  - Notify targeted business users about what must be done and what is forbidden.\n  - Configure logging capabilities in verbose mode on targeted environment and store them in a remove secure server.","status":"Waiting","flag":false,"order":6},{"id":"~204890112","_id":"~204890112","createdBy":"admin@lab.local","createdAt":1748876954664,"_type":"case_task","title":"Network","group":"Preparation","description":"- Make sure that an inventory of the network access points is available and up-to-date.\n- Make sure that network teams have up to date network maps and configurations with concerned zones and operational teams.\n- Look for potential unwanted network access points (xDSL, Wifi, Modem, ...) regularly and close them.\n- Look for VPN access and Cloud access from rare locations.\n- Deploy and monitor traffic management tools.","status":"Waiting","flag":false,"order":1}],"status":"Ok","customFields":{},"metrics":{}}