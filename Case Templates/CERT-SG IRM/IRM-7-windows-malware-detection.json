{"_id":"~41394224","createdBy":"admin@lab.local","updatedBy":"admin@lab.local","createdAt":1734970154985,"updatedAt":1748904088397,"_type":"caseTemplate","name":"IRM#7 Windows Malware Detection","displayName":"","titlePrefix":"","description":"Live Analysis on a suspicious computer","severity":2,"tags":[],"flag":false,"tlp":2,"pap":2,"tasks":[{"id":"~41324696","_id":"~41324696","createdBy":"admin@lab.local","createdAt":1748904088389,"_type":"case_task","title":"Unusual Processes and Services","group":"Identification","description":"**IMPORTANT**\n\nBefore carrying out any other actions, make sure to make a volatile memory capture by downloading and running FTK Imager or another utility from a USB key or disk\nVolatile data provides valuable forensic information and is straightforward to acquire.\n\n**IMPORTANT**\n\n- Check all running processes for unusual/unknown entries, especially processes with username “SYSTEM” and “ADMINISTRATOR” :\n```\nC:\\> taskmgr.exe\n```\n(or `tlisk`, `tasklist` depending on Windows release)\n\n\n- Look for unusual/unexpected network services installed and started:\n```\nC:\\> services.msc\nC:\\> net start\n```\n\nNote: a good knowledge of common Windows services is needed.","status":"Waiting","flag":false,"order":6},{"id":"~41328792","_id":"~41328792","createdBy":"admin@lab.local","createdAt":1748904088393,"_type":"case_task","title":"Remove the binaries and the related registry entries","group":"Remediation","description":"Reboot from a live CD and backup all important data on an external storage support. If unsure, bring your hard-drive to your IT helpdesk and ask them to make a copy of the important content.\n\n- Find the best practices to remove the malware. They can usually be found on AntiVirus companies’ websites.\n- Run an online antivirus scan.\n- Launch a Bart PE- based live CD containing disinfection tools (can be downloaded from AV websites), or a dedicated anti-virus live CD.","status":"Waiting","flag":false,"order":11},{"id":"~82206896","_id":"~82206896","createdBy":"admin@lab.local","createdAt":1748904088388,"_type":"case_task","title":"Unusual Files","group":"Identification","description":"**IMPORTANT**\n\nBefore carrying out any other actions, make sure to make a volatile memory capture by downloading and running FTK Imager or another utility from a USB key or disk\nVolatile data provides valuable forensic information and is straightforward to acquire.\n\n**IMPORTANT**\n\n- Look for unusual big files on the storage support, bigger than 10MB seems to be reasonable.\n- Look for unusual files added recently in system folders, especially *`%SystemRoot%\\system32.`*\n- Look for files using the“hidden”attribute: \n```\nC:\\> dir /S /A:H\n```","status":"Waiting","flag":false,"order":4},{"id":"~82210992","_id":"~82210992","createdBy":"admin@lab.local","createdAt":1748904088396,"_type":"case_task","title":"Capitalize","group":"Lessons Learned","description":"Actions to improve malware detection and eradication processes should be defined to capitalize on this experience.","status":"Waiting","flag":false,"order":15},{"id":"~82272344","_id":"~82272344","createdBy":"admin@lab.local","createdAt":1748904088390,"_type":"case_task","title":"Unusual Network Activity","group":"Identification","description":"**IMPORTANT**\n\nBefore carrying out any other actions, make sure to make a volatile memory capture by downloading and running FTK Imager or another utility from a USB key or disk\nVolatile data provides valuable forensic information and is straightforward to acquire.\n\n**IMPORTANT**\n \n- Check for file shares : \n```\nC:\\> net view \\\\127.0.0.1 \n```\n\n- List opened sessions on the machine:\n```\nC:\\> net session\n```\n\n- Check for opened shares on other systems: \n```\nC:\\> net use\n```\n\n- Check for suspicious Netbios connexions: \n```\nC:\\> nbtstat –S\n```\n\n- Look for any suspicious network connections\n```\nC:\\> netstat –na 5\n```\n(the `-a 5` flag sets the refresh interval to 5 seconds)\n\nAdd the `-o` flag for Windows XP/2003 to dislay the owner of each process\n\n- Use a sniffer (`Wireshark`, `tcpdump` etc...) and see if there are unusual attempts of connections to or from remote systems. try browsing sensitive websites (banking website for example) and check if unusual network activity is triggered.\n\nNote: A good knowledge of the legitimate network activity is needed.","status":"Waiting","flag":false,"order":7},{"id":"~82276440","_id":"~82276440","createdBy":"admin@lab.local","createdAt":1748904088395,"_type":"case_task","title":"Report","group":"Lessons Learned","description":"An incident report should be written and made available to all of the stakeholders.\n\nThe following themes should be described: \n- Initial detection.\n- Actions and timelines.\n- What went right.\n- What went wrong. \n- Incident cost\n- Indicators of Compromise","status":"Waiting","flag":false,"order":14},{"id":"~123248720","_id":"~123248720","createdBy":"admin@lab.local","createdAt":1748904088385,"_type":"case_task","title":"Provide access","group":"Preparation","description":"- Deploy an EDR solution on endpoints and servers\n  - This tool became one of the cornerstones of incident response in case of ransomware or in large scale compromise, facilitating identification, containment, and remediation phases.\n  - Launch EDR Search and AV scan with IOC explicit rules and get first indicators for remediation progress following.\n  - Set your EDR policies in prevent mode to prevent unnecessary business disruption.\n- In absence of EDR, a physical access to the suspicious system should be given to the forensic investigator. Physical access is preferred to remote access, as the hacker could detect the investigations done on the system (by using a network sniffer for example).\n\n\n- A physical copy of the hard-disk might be necessary for forensic and evidence purposes. Finally, if needed, a physical access could be needed to disconnect the suspected machine from any network.\n- Acquisition profiles for EDR or tools like `FastIR`, `DFIR-ORC`, `KAPE`, `DumpIt`, `FTK Imager`, `WinPmem` must be prepared and tested.\n\n- A good knowledge of the usual network activity of the machine/server is needed. You should have a file on a secure place describing the usual port activity, to compare efficiently to the current state.\n` A good knowledge of the usual services running on the machine can be very helpful. Don’t hesitate to ask a Windows Expert for his assistance, when applicable. A good idea is also to have a map of all services/running process of the machine.","status":"Waiting","flag":false,"order":0},{"id":"~123257032","_id":"~123257032","createdBy":"admin@lab.local","createdAt":1748904088387,"_type":"case_task","title":"General signs of malware presence on the desktop","group":"Identification","description":"**The family of malware identified will impact the next steps of the incident response.**\n\n**Investigation will be faster for a Potentially Unwanted Software or a Miner. Stealer, Dropper or Ransomware family will imply a deeper analysis and may lead to another kind of incident (please refer to Large scale malware compromise, Ransomware, Windows Intrusion Detection or Worm Infection if needed)**\n\n**IMPORTANT**\n\nBefore carrying out any other actions, make sure to make a volatile memory capture by downloading and running FTK Imager or another utility from a USB key or disk\nVolatile data provides valuable forensic information and is straightforward to acquire.\n\n**IMPORTANT**\n\nSeveral leads might hint that the system could be compromised by malware:\n- EDR, HIDS, Antivirus software raising an alert, unable to update its signatures, shutting down or unable to run manual scans.\n- Unusual hard-disk activity: the hard drive makes huge operations at unexpected times.\n- Unusually slow computer: sudden, unexplained slowdowns not related to system usage.\n- Unusual network activity: Slow internet connection / poor network share performance at irregular intervals.\n- The computer reboots without reason.\n- Applications crashing unexpectedly.\n- Pop-up windows appearing while browsing the web. (sometimes even without browsing)\n- Your IP address (if static) is blacklisted on one or more Internet Black Lists.\n- People are complaining about you e-mailing them/reaching them by IM etc. while you did not.\n\n**If the issue is considered as strategic (sensitive resources access), a specific crisis management cell should be activated. i.e. Large Scale Compromise IRM-18**\n\nNote:\nActions below uses default Windows tools. Authorized users can use the SysInternals Troubleshooting Utilities to perform these tasks.","status":"Waiting","flag":false,"order":2},{"id":"~123326688","_id":"~123326688","createdBy":"admin@lab.local","createdAt":1748904088386,"_type":"case_task","title":"Endpoints","group":"Preparation","description":"\n- Ensure that the monitoring tools are up to date.\n- Deploy Sysmon, SmartScreen and apply recommendation baselines from ANSSI and CIS.\n- Establish contacts with your network and security operation teams.\n- Make sure that an alert notification process is defined and well-known from everyone.\n- Make sure all equipment are synchronized with the same NTP.\n- Select what kind of files can be lost / stolen and restrict the access for confidential files.\n- Make sure that analysis tools are up, functional (Antivirus, EDR, IDS, logs analyzers), not compromised, and up to date.\n- Install from the same original master.","status":"Waiting","flag":false,"order":1},{"id":"~123523112","_id":"~123523112","createdBy":"admin@lab.local","createdAt":1748904088387,"_type":"case_task","title":"Unusual Accounts","group":"Identification","description":"**IMPORTANT**\n\nBefore carrying out any other actions, make sure to make a volatile memory capture by downloading and running FTK Imager or another utility from a USB key or disk\nVolatile data provides valuable forensic information and is straightforward to acquire.\n\n**IMPORTANT**\n\nLook for unusual and unknown accounts created, especially in the Administrators group:\n\n```\nC:\\> lusrmgr.msc\n```","status":"Waiting","flag":false,"order":3},{"id":"~123527208","_id":"~123527208","createdBy":"admin@lab.local","createdAt":1748904088392,"_type":"case_task","title":"Containment","group":"Containment","description":"Pull the network plug off physically, to prevent more infection on the network and to stop any actions being done from your computer (e.g. the malware could be sending spam, taking part in a DDoS attack or storing illegal files on the system).\n\nSend the suspect binaries to your CERT, or request CERT’s help if you are unsure about the malware’s nature. The CERT should be able to isolate the malicious content and can send it to all AV companies, including your corporate contractors. (The best way is to create a zipped, password-encrypted file of the suspicious binary.)","status":"Waiting","flag":false,"order":10},{"id":"~164220960","_id":"~164220960","createdBy":"admin@lab.local","createdAt":1748904088394,"_type":"case_task","title":"Restore files","group":"Recovery","description":"If possible reinstall the OS and applications and restore user’s data from clean, trusted backups. If deemed necessary, you may ask your local IT helpdesk to reimage the disk.\n\nIn case the computer has not been reinstalled completely:\n**Restore files which could have been corrupted by the malware, especially system files.**","status":"Waiting","flag":false,"order":12},{"id":"~205213696","_id":"~205213696","createdBy":"admin@lab.local","createdAt":1748904088389,"_type":"case_task","title":"Unusual Registry Entries","group":"Identification","description":"**IMPORTANT**\n\nBefore carrying out any other actions, make sure to make a volatile memory capture by downloading and running FTK Imager or another utility from a USB key or disk\nVolatile data provides valuable forensic information and is straightforward to acquire.\n\n**IMPORTANT**\n\nLook for unusual programs launched at boot time in the Windows registry, especially: \n- `HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run`\n- `HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Runonce`\n- `HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\RunonceEx`\n- `HKLM\\Software\\Microsoft\\WindowsNT\\CurrentVersion \\Winlogon`\n\nCheck for the same entries in `HKCU`\n\nYou can use Microsoft Sysinternals Autoruns to view them all.","status":"Waiting","flag":false,"order":5},{"id":"~205217792","_id":"~205217792","createdBy":"admin@lab.local","createdAt":1748904088391,"_type":"case_task","title":"Unusual Automated Tasks","group":"Identification","description":"**IMPORTANT**\n\nBefore carrying out any other actions, make sure to make a volatile memory capture by downloading and running FTK Imager or another utility from a USB key or disk\nVolatile data provides valuable forensic information and is straightforward to acquire.\n\n**IMPORTANT**\n\n- Look at the list of scheduled tasks for any unusual entry: \n```\nC:\\> at\n```\n\n- On Windows 2003/XP: \n```\nC:\\> schtasks\n```\n\n- Also check user’s autostart directories:\n```\nC:\\Documents and Settings\\user\\Start Menu\\Programs\\Startup C:\\WinNT\\Profiles\\user\\Start Menu\\Programs\\Startup\n```","status":"Waiting","flag":false,"order":8},{"id":"~205221888","_id":"~205221888","createdBy":"admin@lab.local","createdAt":1748904088392,"_type":"case_task","title":"Unusual Log Entries","group":"Identification","description":"**IMPORTANT**\n\nBefore carrying out any other actions, make sure to make a volatile memory capture by downloading and running FTK Imager or another utility from a USB key or disk\nVolatile data provides valuable forensic information and is straightforward to acquire.\n\n**IMPORTANT**\n\n- Check log files for unusual entries: \n```\nC:\\> eventvwr.msc\n```\n\n- Search for events like the following:\n```\n“Event log service was stopped”\n“Windows File Protection is not active”\n“The protected System file <name> was not restored to its original”\n“Telnet Service has started successfully”\n```\n\n- Check firewall log files for suspect activity. You can also use an up-to-date antivirus to identify malware on the system, but be aware that it could destroy evidence.\n\n\nIf nothing suspicious has been found, it doesn’t necessarily mean that the system is not infected (a rootkit could have been installed). The system may be investigated further by making a bit-by-bit copy of the incriminated hard-drive and analysing the copy with tools such as X-Ways, FTK or Encase.","status":"Waiting","flag":false,"order":9},{"id":"~205225984","_id":"~205225984","createdBy":"admin@lab.local","createdAt":1748904088394,"_type":"case_task","title":"Reboot the machine","group":"Recovery","description":"If possible reinstall the OS and applications and restore user’s data from clean, trusted backups. If deemed necessary, you may ask your local IT helpdesk to reimage the disk.\n\n**Reboot the machine** after all the suspicious files have been removed, and confirm that the workstation is not exhibiting any unusual behaviour. A full, up-to-date AV scan of the hard-drive and memory are recommended.","status":"Waiting","flag":false,"order":13}],"status":"Ok","customFields":{},"metrics":{}}